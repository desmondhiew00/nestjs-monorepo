import { JwtSignOptions } from '@nestjs/jwt';
import { JwtAuthEnv } from 'configs/env-config';
import { AuthData } from '@app/types';

export const strategy = { jwt: 'app-jwt-auth' };

export const getAccessConfig = (): JwtSignOptions => ({ secret: JwtAuthEnv().ACCESS_TOKEN_SECRET, expiresIn: '1d' });
export const getRefreshConfig = (): JwtSignOptions => ({ secret: JwtAuthEnv().REFRESH_TOKEN_SECRET, expiresIn: '3d' });
export const getForgotPasswordJwtConfig = (): JwtSignOptions => ({
  secret: JwtAuthEnv().FORGOT_PASSWORD_TOKEN_SECRET,
  expiresIn: '1d'
});

export interface JwtSignData extends AuthData {
  id: number;
}
